(this["webpackJsonpadmin-demo"]=this["webpackJsonpadmin-demo"]||[]).push([[0],{428:function(e,t,a){e.exports=a.p+"static/media/logo.583d0581.png"},449:function(e,t,a){e.exports=a(979)},508:function(e,t,a){},592:function(e,t,a){},593:function(e,t,a){},607:function(e,t,a){},977:function(e,t,a){},979:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(30),l=a.n(c),o=a(16),i=a(17),s=a(18),u=a(19),m=a(112),p=a(61),d=(a(78),a(24)),f=(a(97),a(13)),h=(a(83),a(25)),y=a(20),g=a.n(y),v=(a(118),a(62)),b=a(51),E=a(980),k=a(981),O=a(419),j=a(290),x=a.n(j);function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"GET";return new Promise((function(n,r){("GET"===a?x.a.get(e,{params:t}):x.a.post(e,t)).then((function(e){n(e.data)})).catch((function(e){v.b.error("\u8bf7\u6c42\u51fa\u9519\u4e86: "+e.message)}))}))}var C=a(421),I=a.n(C),S=function(e,t){return w("/login",{username:e,password:t},"POST")},R=function(e){return w("/manage/category/list",{parentId:e})},N=function(e,t){return w("/manage/category/add",{parentId:e,categoryName:t},"POST")},T=function(e){return w("/manage/category/update",{categoryId:e.categoryId,categoryName:e.categoryName},"POST")},P=function(e){return w("/manage/category/detele",{name:e},"POST")},_=function(e,t){return w("/manage/product/list",{pageNum:e,pageSize:t})},A=function(e){var t=e.pageNum,a=e.pageSize,n=e.searchName,r=e.searchType;return w("/manage/product/search",Object(O.a)({pageNum:t,pageSize:a},r,n))},F=function(e){return w("/manage/product/add",e,"POST")},q=function(e){return w("/manage/product/delete",{categoryId:e},"POST")},M=function(e,t){return w("/manage/product/sell",{productId:e,productNum:t},"POST")},U=function(){return w("/manage/user/list")},D=function(e){return w("/manage/user/"+(e._id?"update":"add"),e,"POST")},V=function(e){return w("/manage/user/delete",{userId:e},"POST")},K=function(e){return w("/manage/role/add",{roleName:e},"POST")},W=function(e){return w("/manage/role/update",e,"POST")},z=function(){return new Promise((function(e,t){I()("https://v0.yiketianqi.com/api?version=v62&appid=57658385&appsecret=JgA025en",{},(function(t,a){if(console.log(a.hours[0]),console.log(a.week),t)v.b.error("\u83b7\u53d6\u5929\u6c14\u9884\u62a5\u5931\u8d25!");else{var n=a.week,r=a.hours[0],c=r.wea,l=r.tem;e({wea:c,tem:l,week:n})}}))}))},H={user:{}},J=a(242),L=a.n(J),B=function(e){L.a.set("user_key",e)},G=function(){return L.a.get("user_key")||{}},Q=function(){L.a.remove("user_key")},$=(a(508),function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).formRef=r.a.createRef(),e.onFinish=function(t){e.formRef.current.validateFields().then(function(){var t=Object(b.a)(g.a.mark((function t(a){var n,r,c,l;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.username,r=a.password,t.next=3,S(n,r);case 3:0===(c=t.sent).status?(v.b.success("\u767b\u5f55\u6210\u529f"),l=c.data,H.user=l,B(l),e.props.history.replace("/")):v.b.error(c.msg);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))},e}return Object(i.a)(a,[{key:"render",value:function(){var e=H.user;return e&&e._id?r.a.createElement(p.a,{to:"/"}):r.a.createElement("div",{className:"login"},r.a.createElement("div",{className:"login-content"},r.a.createElement("h2",null,"\u5c0fE\u8d85\u5e02\u7ba1\u7406\u7cfb\u7edf"),r.a.createElement(f.a,{name:"normal_login",className:"login-form",initialValues:{remember:!0},onFinish:this.onFinish,ref:this.formRef},r.a.createElement(f.a.Item,{name:"username",rules:[{required:!0,whitespace:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d!"},{min:4,message:"\u7528\u6237\u540d\u81f3\u5c114\u4f4d!"},{max:12,message:"\u7528\u6237\u540d\u6700\u591a12\u4f4d!"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u7531\u82f1\u6587\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210!"}],initialValue:"admin"},r.a.createElement(h.a,{prefix:r.a.createElement(E.a,{className:"site-form-item-icon"}),placeholder:"Username"})),r.a.createElement(f.a.Item,{name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801!"},{min:4,message:"\u5bc6\u7801\u81f3\u5c114\u4f4d!"},{max:12,message:"\u5bc6\u7801\u6700\u591a12\u4f4d!"}],initialValue:"admin"},r.a.createElement(h.a,{prefix:r.a.createElement(k.a,{className:"site-form-item-icon"}),type:"password",placeholder:"Password"})),r.a.createElement(f.a.Item,null,r.a.createElement(d.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"\u767b\u5f55")))))}}]),a}(n.Component)),Z=(a(589),a(168)),X=(a(171),a(74)),Y=a(222);function ee(e){if(!e)return"";var t=new Date(e);return t.getFullYear()+"-"+(t.getMonth()+1)+"-"+t.getDate()+" "+t.getHours()+":"+t.getMinutes()+":"+t.getSeconds()}var te=a(982),ae=a(983),ne=a(984),re=a(985),ce=a(986),le=a(987),oe=a(988),ie=a(989),se=a(990),ue=[{title:"\u9996\u9875",key:"/home",icon:r.a.createElement(te.a,null),isPublic:!0},{title:"\u5546\u54c1",key:"/products",icon:r.a.createElement(ae.a,null),children:[{title:"\u54c1\u7c7b\u7ba1\u7406",key:"/category",icon:r.a.createElement(ne.a,null)},{title:"\u5546\u54c1\u7ba1\u7406",key:"/product",icon:r.a.createElement(re.a,null)}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/user",icon:r.a.createElement(E.a,null)},{title:"\u89d2\u8272\u7ba1\u7406",key:"/role",icon:r.a.createElement(ce.a,null)},{title:"\u56fe\u5f62\u56fe\u8868",key:"/charts",icon:r.a.createElement(le.a,null),children:[{title:"\u67f1\u5f62\u56fe",key:"/charts/bar",icon:r.a.createElement(oe.a,null)},{title:"\u6298\u7ebf\u56fe",key:"/charts/line",icon:r.a.createElement(ie.a,null)},{title:"\u997c\u56fe",key:"/charts/pie",icon:r.a.createElement(se.a,null)}]}];a(592),a(593);function me(e){return r.a.createElement("button",Object.assign({},e,{className:"link-button"}))}var pe=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={currentTime:ee(Date.now()),wea:"",tem:"",week:""},e.getTime=function(){setInterval((function(){var t=ee(Date.now());e.setState({currentTime:t})}),1e3)},e.getWeather=Object(b.a)(g.a.mark((function t(){var a,n,r,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z();case 2:a=t.sent,n=a.wea,r=a.tem,c=a.week,e.setState({wea:n,tem:r,week:c});case 7:case"end":return t.stop()}}),t)}))),e.getTitle=function(){var t,a=e.props.location.pathname;return ue.forEach((function(e){if(e.key===a)t=e.title;else if(e.children){var n=e.children.find((function(e){return 0===a.indexOf(e.key)}));n&&(t=n.title)}})),t},e.logout=function(){X.a.confirm({content:"\u786e\u5b9a\u9000\u51fa\u5417?",okText:"\u786e\u8ba4",cancelText:"\u53d6\u6d88",onOk:function(){console.log("OK",Object(Y.a)(e)),Q(),H.user={},e.props.history.replace("/login")}})},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.getTime(),this.getWeather()}},{key:"componentWillUnmount",value:function(){clearInterval(this.intervalId)}},{key:"render",value:function(){var e=this.state,t=e.currentTime,a=e.wea,n=e.tem,c=e.week,l=H.user.username,o=this.getTitle();return r.a.createElement("div",{className:"Header"},r.a.createElement("div",{className:"Header-top"},r.a.createElement("span",null,"\u6b22\u8fce,",l),r.a.createElement(me,{onClick:this.logout},"\u9000\u51fa")),r.a.createElement("div",{className:"Header-bottom"},r.a.createElement("div",{className:"Header-bottom-left"},o),r.a.createElement("div",{className:"Header-bottom-right"},r.a.createElement("span",null,t),r.a.createElement("span",null,c),r.a.createElement("span",null,a),r.a.createElement("span",null,n+"\u2103"))))}}]),a}(n.Component),de=Object(p.g)(pe),fe=(a(604),a(94)),he=a(428),ye=a.n(he),ge=(a(607),fe.a.SubMenu),ve=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={collapsed:!1},e.hasAuth=function(e){var t=e.key,a=e.isPublic,n=H.user.role.menus;return!("admin"!==H.user.username&&!a&&-1===n.indexOf(t))||!!e.children&&!!e.children.find((function(e){return-1!==n.indexOf(e.key)}))},e.getMenuNodes=function(t){var a=e.props.location.pathname;return t.reduce((function(t,n){e.hasAuth(n)&&(n.children?(n.children.find((function(e){return 0===a.indexOf(e.key)}))&&(e.openKey=n.key),t.push(r.a.createElement(ge,{key:n.key,icon:n.icon,title:n.title},e.getMenuNodes(n.children)))):t.push(r.a.createElement(fe.a.Item,{key:n.key,icon:n.icon},r.a.createElement(m.b,{to:n.key},n.title))));return t}),[])},e}return Object(i.a)(a,[{key:"componentWillMount",value:function(){this.menuNodes=this.getMenuNodes(ue)}},{key:"render",value:function(){var e=this.props.location.pathname;0===e.indexOf("/product")&&(e="/product");var t=this.openKey;return r.a.createElement("div",{className:"left-nav"},r.a.createElement(m.b,{to:"/",className:"left-nav-header"},r.a.createElement("img",{src:ye.a,alt:"logo"}),r.a.createElement("h1",null,"\u5c0fE\u540e\u53f0")),r.a.createElement(fe.a,{selectedKeys:[e],defaultOpenKeys:[t],mode:"inline",theme:"dark"},this.menuNodes))}}]),a}(n.Component),be=Object(p.g)(ve),Ee=(a(249),a(107)),ke=(a(250),a(72)),Oe=(a(111),a(58)),je=(a(616),a(296)),xe=a(991),we=a(992),Ce=a(126),Ie=a.n(Ce),Se=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).getOption=function(){return{title:{text:"\u9500\u552e\u7edf\u8ba1"},tooltip:{trigger:"axis"},legend:{data:["\u6587\u5177","\u5a03\u54c8\u54c8","\u9152","\u70df","\u852c\u83dc"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},xAxis:{type:"category",boundaryGap:!1,data:["\u5468\u4e00","\u5468\u4e8c","\u5468\u4e09","\u5468\u56db","\u5468\u4e94","\u5468\u516d","\u5468\u65e5"]},yAxis:{type:"value"},series:[{name:"\u6587\u5177",type:"line",stack:"\u603b\u91cf",data:[120,132,101,134,90,230,210]},{name:"\u5a03\u54c8\u54c8",type:"line",stack:"\u603b\u91cf",data:[220,182,191,234,290,330,310]},{name:"\u9152",type:"line",stack:"\u603b\u91cf",data:[150,232,201,154,190,330,410]},{name:"\u70df",type:"line",stack:"\u603b\u91cf",data:[320,332,301,334,390,330,320]},{name:"\u852c\u83dc",type:"line",stack:"\u603b\u91cf",data:[820,932,901,934,1290,1330,1320]}]}},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Ie.a,{option:this.getOption()}))}}]),a}(n.Component),Re=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Oe.a,null,r.a.createElement(Ee.a,{gutter:4},r.a.createElement(ke.a,{span:3},r.a.createElement(Oe.a,null,r.a.createElement(je.a,{title:"\u540c\u4e0a\u5468\u76f8\u6bd4",value:11.28,precision:2,valueStyle:{color:"#3f8600"},prefix:r.a.createElement(xe.a,null),suffix:"%"}))),r.a.createElement(ke.a,{span:3},r.a.createElement(Oe.a,null,r.a.createElement(je.a,{title:"\u540c\u4e0a\u4e2a\u6708\u76f8\u6bd4",value:9.3,precision:2,valueStyle:{color:"#cf1322"},prefix:r.a.createElement(we.a,null),suffix:"%"})))),r.a.createElement(Se,null)))}}]),a}(n.Component),Ne=(a(221),a(127)),Te=(a(187),a(70)),Pe=Te.a.Option,_e=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).formRef=r.a.createRef(),e}return Object(i.a)(a,[{key:"componentWillMount",value:function(){this.props.setForm(this.formRef)}},{key:"render",value:function(){var e=this.props,t=e.categorys,a=e.parentId;return r.a.createElement(f.a,{ref:this.formRef},r.a.createElement("span",null,"\u5206\u7c7b\u7ea7\u522b:"),r.a.createElement(f.a.Item,{name:"category",initialValue:a},r.a.createElement(Te.a,null,r.a.createElement(Pe,{value:"0"},"\u4e00\u7ea7\u5206\u7c7b"),t.map((function(e){return r.a.createElement(Pe,{value:e._id},e.name)})))),r.a.createElement("span",null,"\u5206\u7c7b\u540d\u79f0:"),r.a.createElement(f.a.Item,{name:"categoryName",rules:[{required:!0,message:"\u5206\u7c7b\u540d\u79f0\u5fc5\u987b\u8f93\u5165!"}]},r.a.createElement(h.a,null)))}}]),a}(n.Component),Ae=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).formRef=r.a.createRef(),e}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(){this.formRef.current.setFieldsValue({categoryName:this.props.categoryName})}},{key:"componentWillMount",value:function(){this.props.setForm(this.formRef)}},{key:"render",value:function(){var e=this.props.categoryName;return r.a.createElement(f.a,{ref:this.formRef},r.a.createElement(f.a.Item,{name:"categoryName",initialValue:e,rules:[{required:!0,message:"\u5206\u7c7b\u540d\u79f0\u5fc5\u987b\u8f93\u5165!"}]},r.a.createElement(h.a,{placeholder:"\u8bf7\u8f93\u5165\u5206\u7c7b\u540d\u79f0"})))}}]),a}(n.Component),Fe=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={loading:!1,categorys:[],subCategorys:[],parentId:"0",parentName:"",visible:0},e.inintColumns=function(){e.columns=[{title:"\u5206\u7c7b\u540d\u79f0",align:"center",dataIndex:"name",key:"name"},{title:"\u64cd\u4f5c",width:500,align:"center",render:function(t,a){return r.a.createElement("span",null,r.a.createElement(d.a,{type:"primary",onClick:function(){return e.update(t)}},"\u4fee\u6539\u5206\u7c7b"),"0"===e.state.parentId?r.a.createElement(d.a,{type:"dashed",onClick:function(){return e.showSubCategorys(t)}},"\u67e5\u770b\u5b50\u5206\u7c7b"):null,r.a.createElement(d.a,{type:"primary",danger:!0,onClick:function(){return e.removeCategory(a)}},"\u5220\u9664"))}}]},e.getCategorys=Object(b.a)(g.a.mark((function t(){var a,n,r;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({loading:!0}),a=e.state.parentId,t.next=4,R(a);case 4:n=t.sent,e.setState({loading:!1}),0===n.status?(r=n.data,"0"===a?e.setState({categorys:r}):e.setState({subCategorys:r})):v.b.error("\u83b7\u53d6\u5206\u7c7b\u5217\u8868\u5931\u8d25");case 7:case"end":return t.stop()}}),t)}))),e.showSubCategorys=function(t){e.setState({parentId:t._id,parentName:t.name},(function(){e.getCategorys()}))},e.showCategorys=function(){e.setState({parentId:"0",parentName:"",subCategorys:[]})},e.Add=function(){e.setState({visible:1})},e.addCategory=function(){e.formRef.current.validateFields().then(function(){var t=Object(b.a)(g.a.mark((function t(a){var n,r,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({visible:0}),n=e.formRef.current.getFieldValue(),r=n.category,c=n.categoryName,console.log(r,c),e.formRef.current.resetFields(),t.next=6,N(r,c);case 6:0===t.sent.status&&(r===e.state.parentId?e.getCategorys():"0"===r&&e.getCategorys("0"));case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},e.update=function(t){e.category=t,e.setState({visible:2})},e.updateCategory=function(){e.formRef.current.validateFields().then(function(){var t=Object(b.a)(g.a.mark((function t(a){var n,r;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({visible:0}),n=e.category._id,r=a.categoryName,console.log(n,r),e.formRef.current.resetFields(),t.next=7,T({categoryId:n,categoryName:r});case 7:0===t.sent.status&&e.getCategorys();case 9:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()).catch((function(e){console.log(e)}))},e.removeCategory=function(){var t=Object(b.a)(g.a.mark((function t(a){var n;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return console.log(a),n=a.name,console.log(n),t.next=5,P(n);case 5:0===t.sent.status&&(v.b.success("\u5220\u9664\u6210\u529f"),e.getCategorys());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleCancel=function(){e.setState({visible:0})},e}return Object(i.a)(a,[{key:"componentWillMount",value:function(){this.inintColumns()}},{key:"componentDidMount",value:function(){this.getCategorys()}},{key:"render",value:function(){var e=this,t=this.state,a=t.categorys,n=t.subCategorys,c=t.parentId,l=t.parentName,o=t.loading,i=t.visible,s=this.category||{},u="0"===c?"\u4e00\u7ea7\u5206\u7c7b":r.a.createElement("span",null,r.a.createElement(me,{onClick:this.showCategorys},"\u4e00\u7ea7\u5206\u7c7b\u5217\u8868"),r.a.createElement("span",{style:{margin:10}},">"),r.a.createElement("span",null,l)),m=r.a.createElement(d.a,{type:"primary",onClick:this.Add},"\u6dfb\u52a0\u5206\u7c7b");return r.a.createElement(Oe.a,{title:u,extra:m},r.a.createElement(Ne.a,{dataSource:"0"===c?a:n,columns:this.columns,bordered:!0,rowKey:"_id",loading:o,pagination:{defaultPageSize:5,showQuickJumper:!0}}),r.a.createElement(X.a,{title:"\u6dfb\u52a0\u5206\u7c7b",visible:1===i,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.addCategory,onCancel:this.handleCancel},r.a.createElement(_e,{categorys:a,parentId:c,setForm:function(t){e.formRef=t}})),r.a.createElement(X.a,{title:"\u4fee\u6539\u5206\u7c7b",visible:2===i,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.updateCategory,onCancel:this.handleCancel},r.a.createElement(Ae,{categoryName:s.name,setForm:function(t){e.formRef=t}})))}}]),a}(n.Component),qe=(a(418),a(240)),Me=a(166),Ue=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).formRef=r.a.createRef(),e.state={options:[]},e.loadData=function(){var t=Object(b.a)(g.a.mark((function t(a){var n,r,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=a[0]).loading=!0,t.next=4,e.getCategorys(n.value);case 4:r=t.sent,n.loading=!1,r&&r.length>0?(c=r.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),n.children=c):n.isLeaf=!0,e.setState({options:Object(Me.a)(e.state.options)});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(){this.formRef.current.setFieldsValue({pCategoryId:this.props.product.pCategoryId,categoryId:this.props.product.categoryId,name:this.props.product.name,model:this.props.product.model,unit:this.props.product.unit,number:this.props.product.number,Pprice:this.props.product.Pprice,Oprice:this.props.product.Oprice})}},{key:"render",value:function(){var e=this.props.product,t=e.name,a=e.model,n=e.unit,c=e.number,l=e.Pprice,o=e.Oprice;return r.a.createElement(f.a,{ref:this.formRef},r.a.createElement(f.a.Item,{name:"name",label:"\u5546\u54c1\u540d\u79f0",initialValue:t,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}]},r.a.createElement(h.a,null)),r.a.createElement(f.a.Item,{name:"model",label:"\u5546\u54c1\u578b\u53f7",initialValue:a,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u578b\u53f7"}]},r.a.createElement(h.a,null)),r.a.createElement(f.a.Item,{name:"number",label:"\u8d2d\u4e70\u6570\u91cf",initialValue:c,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d2d\u4e70\u6570\u91cf"}]},r.a.createElement(h.a,null)),r.a.createElement(f.a.Item,{name:"unit",label:"\u5355\u4f4d",initialValue:n,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u5355\u4f4d"}]},r.a.createElement(h.a,null)),r.a.createElement(f.a.Item,{name:"Pprice",label:"\u91c7\u8d2d\u4ef7",initialValue:l,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u91c7\u8d2d\u4ef7"}]},r.a.createElement(h.a,{prefix:"\uffe5"})),r.a.createElement(f.a.Item,{name:"Oprice",label:"\u51fa\u552e\u4ef7",initialValue:o,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u51fa\u552e\u4ef7"}]},r.a.createElement(h.a,{prefix:"\uffe5"})),r.a.createElement(f.a.Item,{name:"categoryIds",label:"\u5546\u54c1\u7c7b\u522b"},r.a.createElement(qe.a,{options:this.state.options,loadData:this.loadData,placeholder:"\u8bf7\u9009\u62e9\u5546\u54c1\u7c7b\u522b"})))}}]),a}(n.Component),De=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).formRef=r.a.createRef(),e}return Object(i.a)(a,[{key:"componentDidUpdate",value:function(){this.formRef.current.setFieldsValue({name:this.props.product.name})}},{key:"componentWillMount",value:function(){this.props.setForm(this.formRef)}},{key:"render",value:function(){var e=this.props.product;return r.a.createElement(f.a,{ref:this.formRef},r.a.createElement(f.a.Item,{name:"name",label:"\u5546\u54c1\u540d\u79f0",initialValue:e.name,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}]},r.a.createElement(h.a,null)),r.a.createElement(f.a.Item,{name:"num",label:"\u5356\u51fa\u6570\u91cf",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5356\u51fa\u6570\u91cf"}]},r.a.createElement(h.a,null)))}}]),a}(n.Component),Ve=Te.a.Option,Ke=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={tatol:0,products:[],loading:!1,searchName:"",searchType:"productName",visible:0},e.inintColumns=function(){e.columns=[{title:"\u5546\u54c1\u540d\u79f0",width:200,dataIndex:"name",fixed:"left"},{title:"\u578b\u53f7",dataIndex:"model"},{title:"\u5355\u4f4d",dataIndex:"unit"},{title:"\u6570\u91cf",dataIndex:"number"},{title:"\u91c7\u8d2d\u4ef7",dataIndex:"Pprice",render:function(e){return"\xa5"+e}},{title:"\u51fa\u552e\u4ef7",dataIndex:"Oprice",render:function(e){return"\xa5"+e}},{title:"\u64cd\u4f5c",key:"operation",fixed:"right",width:200,render:function(t,a){return r.a.createElement("span",null,r.a.createElement(d.a,{type:"primary",size:"small",onClick:function(){return e.Update(t)}},"\u7f16\u8f91"),r.a.createElement(d.a,{type:"primary",danger:!0,size:"small",style:{margin:"0 10px"},onClick:function(){return e.removeProduct(a)}},"\u5220\u9664"),r.a.createElement(d.a,{type:"primary",danger:!0,size:"small",onClick:function(){return e.sell(t)}},"\u5356\u51fa"))}}]},e.getProducts=function(){var t=Object(b.a)(g.a.mark((function t(a){var n,r,c,l,o;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.pageNum=a,e.setState({loading:!0}),n=e.state,r=n.searchName,c=n.searchType,!r){t.next=9;break}return t.next=6,A({pageNum:a,pageSize:5,searchName:r,searchType:c});case 6:l=t.sent,t.next=12;break;case 9:return t.next=11,_(a);case 11:l=t.sent;case 12:e.setState({loading:!1}),0===l.status&&(o=l.data,e.setState({products:o}));case 14:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.removeProduct=function(){var t=Object(b.a)(g.a.mark((function t(a){var n;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.categoryId,t.next=3,q(n);case 3:0===t.sent.status&&(v.b.success("\u5220\u9664\u6210\u529f"),e.getProducts());case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.Update=function(t){e.product=t,console.log(t),e.setState({visible:1})},e.UpdateProduct=function(){e.setState({visible:0})},e.handleCancel=function(){e.setState({visible:0})},e.sell=function(t){e.product=t,e.setState({visible:2})},e.sellProduct=function(){e.formRef.current.validateFields().then(function(){var t=Object(b.a)(g.a.mark((function t(a){var n,r;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.setState({visible:0}),n=e.product._id,r=e.product.number-1*a.num,e.formRef.current.resetFields(),t.next=6,M(n,r);case 6:0===t.sent.status&&e.getProducts();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},e}return Object(i.a)(a,[{key:"componentWillMount",value:function(){this.inintColumns()}},{key:"componentDidMount",value:function(){this.getProducts()}},{key:"render",value:function(){var e=this,t=this.state,a=t.products,n=t.total,c=t.loading,l=t.searchName,o=t.searchType,i=t.visible,s=this.product||{},u=r.a.createElement("span",null,r.a.createElement(Te.a,{value:o,style:{width:120},onChange:function(t){return e.setState({searchType:t})}},r.a.createElement(Ve,{value:"productName"},"\u6309\u540d\u79f0\u641c\u7d22"),r.a.createElement(Ve,{value:"productDesc"},"\u6309\u578b\u53f7\u641c\u7d22")),r.a.createElement(h.a,{placeholder:"\u5173\u952e\u5b57",style:{width:150,margin:"0 15px"},value:l,onChange:function(t){return e.setState({searchName:t.target.value})}}),r.a.createElement(d.a,{type:"primary",onClick:function(){return e.getProducts(1)}},"\u641c\u7d22")),m=r.a.createElement(d.a,{type:"primary",onClick:function(){return e.props.history.push("/product/addupdate")}},"\u6dfb\u52a0\u5546\u54c1");return r.a.createElement(Oe.a,{title:u,extra:m},r.a.createElement(Ne.a,{bordered:!0,loading:c,rowKey:"_id",columns:this.columns,dataSource:a,scroll:{x:1300},pagination:{current:this.pageNum,total:n,defaultPageSize:5,showQuickJumper:!0,onChange:this.getProducts}}),r.a.createElement(X.a,{title:"\u4fee\u6539\u5546\u54c1",visible:1===i,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.UpdateProduct,onCancel:this.handleCancel},r.a.createElement(Ue,{product:s})),r.a.createElement(X.a,{title:"\u5356\u51fa\u5546\u54c1",visible:2===i,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.sellProduct,onCancel:this.handleCancel},r.a.createElement(De,{product:s,setForm:function(t){e.formRef=t}})))}}]),a}(n.Component),We=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).formRef=r.a.createRef(),e.state={options:[]},e.initOptions=function(t){var a=t.map((function(e){return{value:e._id,label:e.name,isLeaf:!1}}));e.setState({options:a})},e.getCategorys=function(){var t=Object(b.a)(g.a.mark((function t(a){var n,r;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,R(a);case 2:if(0!==(n=t.sent).status){t.next=10;break}if(r=n.data,"0"!==a){t.next=9;break}e.initOptions(r),t.next=10;break;case 9:return t.abrupt("return",r);case 10:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.loadData=function(){var t=Object(b.a)(g.a.mark((function t(a){var n,r,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return(n=a[0]).loading=!0,t.next=4,e.getCategorys(n.value);case 4:r=t.sent,n.loading=!1,r&&r.length>0?(c=r.map((function(e){return{value:e._id,label:e.name,isLeaf:!0}})),n.children=c):n.isLeaf=!0,e.setState({options:Object(Me.a)(e.state.options)});case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.submit=function(){e.formRef.current.validateFields().then(function(){var t=Object(b.a)(g.a.mark((function t(a){var n,r,c,l,o,i,s,u,m,p,d;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=a.name,r=a.model,c=a.number,l=a.unit,o=a.Pprice,i=a.Oprice,s=a.factory,1===(u=a.categoryIds).length?(m="0",p=u[0]):(m=u[0],p=u[1]),d={name:n,model:r,number:c,unit:l,Pprice:o,Oprice:i,factory:s,categoryId:p,pCategoryId:m},t.next=5,F(d);case 5:0===t.sent.status&&(v.b.success("\u6dfb\u52a0\u6210\u529f"),e.props.history.goBack());case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},e}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.getCategorys("0")}},{key:"render",value:function(){var e=this.state.options;return r.a.createElement(Oe.a,{title:"\u6dfb\u52a0\u5546\u54c1",bordered:!1},r.a.createElement(f.a,{labelCol:{span:5},wrapperCol:{span:8},ref:this.formRef},r.a.createElement(f.a.Item,{name:"name",label:"\u5546\u54c1\u540d\u79f0",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u540d\u79f0"}]},r.a.createElement(h.a,null)),r.a.createElement(f.a.Item,{name:"model",label:"\u5546\u54c1\u578b\u53f7",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u578b\u53f7"}]},r.a.createElement(h.a,null)),r.a.createElement(f.a.Item,{name:"number",label:"\u8d2d\u4e70\u6570\u91cf",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u8d2d\u4e70\u6570\u91cf"}]},r.a.createElement(h.a,null)),r.a.createElement(f.a.Item,{name:"unit",label:"\u5355\u4f4d",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5546\u54c1\u5355\u4f4d"}]},r.a.createElement(h.a,null)),r.a.createElement(f.a.Item,{name:"Pprice",label:"\u91c7\u8d2d\u4ef7",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u91c7\u8d2d\u4ef7"}]},r.a.createElement(h.a,{prefix:"\uffe5"})),r.a.createElement(f.a.Item,{name:"Oprice",label:"\u51fa\u552e\u4ef7",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u51fa\u552e\u4ef7"}]},r.a.createElement(h.a,{prefix:"\uffe5"})),r.a.createElement(f.a.Item,{name:"Factory",label:"\u751f\u4ea7\u5382\u5bb6",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u751f\u4ea7\u5382\u5bb6"}]},r.a.createElement(h.a,null)),r.a.createElement(f.a.Item,{name:"categoryIds",label:"\u5546\u54c1\u7c7b\u522b"},r.a.createElement(qe.a,{options:e,loadData:this.loadData,placeholder:"\u8bf7\u9009\u62e9\u5546\u54c1\u7c7b\u522b"})),r.a.createElement(f.a.Item,null,r.a.createElement(d.a,{type:"primary",htmlType:"submit",style:{margin:"0 360px"},onClick:this.submit},"\u63d0\u4ea4"))))}}]),a}(n.Component),ze=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(p.d,null,r.a.createElement(p.b,{path:"/product",component:Ke,exact:!0}),r.a.createElement(p.b,{path:"/product/addupdate",component:We}),r.a.createElement(p.a,{to:"/product"}))}}]),a}(n.Component),He=Te.a.Option,Je=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).formRef=r.a.createRef(),e}return Object(i.a)(a,[{key:"componentWillMount",value:function(){this.props.setForm(this.formRef)}},{key:"render",value:function(){var e=this.props.roles;return r.a.createElement(f.a,{ref:this.formRef,labelCol:{span:5},wrapperCol:{span:15}},r.a.createElement(f.a.Item,{label:"\u7528\u6237\u540d",name:"username",rules:[{required:!0,whitespace:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d!"},{min:4,message:"\u7528\u6237\u540d\u81f3\u5c114\u4f4d!"},{max:12,message:"\u7528\u6237\u540d\u6700\u591a12\u4f4d!"},{pattern:/^[a-zA-Z0-9_]+$/,message:"\u7528\u6237\u540d\u5fc5\u987b\u7531\u82f1\u6587\u3001\u6570\u5b57\u6216\u4e0b\u5212\u7ebf\u7ec4\u6210!"}]},r.a.createElement(h.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})),r.a.createElement(f.a.Item,{label:"\u5bc6\u7801",name:"password",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u5bc6\u7801!"},{min:4,message:"\u5bc6\u7801\u81f3\u5c114\u4f4d!"},{max:12,message:"\u5bc6\u7801\u6700\u591a12\u4f4d!"}]},r.a.createElement(h.a.Password,{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"})),r.a.createElement(f.a.Item,{label:"\u624b\u673a\u53f7",name:"phone",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"},{pattern:/^[1][3,4,5,7,8][0-9]{9}$/,message:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7!"}]},r.a.createElement(h.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7"})),r.a.createElement(f.a.Item,{name:"email",label:"E-mail",rules:[{type:"email",message:"\u8bf7\u8f93\u5165\u90ae\u7bb1!"},{required:!0,message:"\u8bf7\u8f93\u5165\u90ae\u7bb1!"}]},r.a.createElement(h.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1"})),r.a.createElement(f.a.Item,{label:"\u89d2\u8272",name:"role_id",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}]},r.a.createElement(Te.a,{placeholder:"\u8bf7\u9009\u62e9\u89d2\u8272"},e.map((function(e){return r.a.createElement(He,{key:e._id,value:e._id},e.name)})))))}}]),a}(n.Component),Le=Te.a.Option,Be=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).formRef=r.a.createRef(),e}return Object(i.a)(a,[{key:"componentWillMount",value:function(){this.props.setForm(this.formRef)}},{key:"render",value:function(){var e=this.props,t=e.roles,a=e.user;return r.a.createElement(f.a,{ref:this.formRef,labelCol:{span:5},wrapperCol:{span:15}},r.a.createElement(f.a.Item,{label:"\u7528\u6237\u540d",name:"username",initialValue:a.username,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}]},r.a.createElement(h.a,{placeholder:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"})),a._id?null:r.a.createElement(f.a.Item,{label:"\u5bc6\u7801",name:"password",initialValue:a.password,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}]},r.a.createElement(h.a.Password,{placeholder:"\u8bf7\u8f93\u5165\u5bc6\u7801"})),r.a.createElement(f.a.Item,{label:"\u624b\u673a\u53f7",name:"phone",initialValue:a.phone,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}]},r.a.createElement(h.a,{placeholder:"\u8bf7\u8f93\u5165\u624b\u673a\u53f7"})),r.a.createElement(f.a.Item,{name:"email",label:"E-mail",initialValue:a.email,rules:[{type:"email",message:"\u8bf7\u8f93\u5165\u90ae\u7bb1!"},{required:!0,message:"\u8bf7\u8f93\u5165\u90ae\u7bb1!"}]},r.a.createElement(h.a,{placeholder:"\u8bf7\u8f93\u5165\u90ae\u7bb1"})),r.a.createElement(f.a.Item,{label:"\u89d2\u8272",name:"role_id",initialValue:a.role_id,rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d"}]},r.a.createElement(Te.a,{placeholder:"\u8bf7\u9009\u62e9\u89d2\u8272"},t.map((function(e){return r.a.createElement(Le,{key:e._id,value:e._id},e.name)})))))}}]),a}(n.Component),Ge=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).state={users:[],roles:[],visible:!1},e.initColumns=function(){e.columns=[{title:"\u7528\u6237\u540d",dataIndex:"username"},{title:"\u90ae\u7bb1",dataIndex:"email"},{title:"\u7535\u8bdd",dataIndex:"phone"},{title:"\u6ce8\u518c\u65f6\u95f4",dataIndex:"create_time",render:ee},{title:"\u6240\u5c5e\u89d2\u8272",dataIndex:"role_id",render:function(t){return e.roleNames[t]}},{title:"\u64cd\u4f5c",render:function(t){return r.a.createElement("span",null,r.a.createElement(d.a,{type:"primary",style:{marginRight:15},onClick:function(){return e.showUpdate(t)}},"\u4fee\u6539"),r.a.createElement(d.a,{type:"primary",danger:!0,onClick:function(){return e.deleteUser(t)}},"\u5220\u9664"))}}]},e.initRoleNames=function(t){var a=t.reduce((function(e,t){return e[t._id]=t.name,e}),{});e.roleNames=a},e.getUsers=Object(b.a)(g.a.mark((function t(){var a,n,r,c;return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,U();case 2:0===(a=t.sent).status&&(n=a.data,r=n.users,c=n.roles,e.initRoleNames(c),e.setState({users:r,roles:c}));case 4:case"end":return t.stop()}}),t)}))),e.showAdd=function(){e.user=null,e.setState({visible:1})},e.showUpdate=function(t){e.user=t,e.setState({visible:2})},e.addOrUpdateUser=function(){e.setState({visible:!1}),e.formRef.current.validateFields().then(function(){var t=Object(b.a)(g.a.mark((function t(a){return g.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.user&&(a._id=e.user._id),e.formRef.current.resetFields(),t.next=4,D(a);case 4:0===t.sent.status&&(v.b.success("".concat(e.user?"\u4fee\u6539":"\u6dfb\u52a0","\u7528\u6237\u6210\u529f")),e.getUsers());case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},e.deleteUser=function(t){X.a.confirm({title:"\u786e\u8ba4\u5220\u9664".concat(t.username,"\u5417?"),onOk:function(){var a=Object(b.a)(g.a.mark((function a(){return g.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,V(t._id);case 2:0===a.sent.status&&(v.b.success("\u5220\u9664\u7528\u6237\u6210\u529f!"),e.getUsers());case 4:case"end":return a.stop()}}),a)})));return function(){return a.apply(this,arguments)}}()})},e}return Object(i.a)(a,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getUsers()}},{key:"render",value:function(){var e=this,t=this.state,a=t.users,n=t.visible,c=t.roles,l=this.user||{},o=r.a.createElement(d.a,{type:"primary",onClick:this.showAdd},"\u521b\u5efa\u7528\u6237");return r.a.createElement(Oe.a,{title:o},r.a.createElement(Ne.a,{bordered:!0,rowKey:"_id",columns:this.columns,dataSource:a,pagination:{defaultPageSize:5}}),r.a.createElement(X.a,{title:"\u6dfb\u52a0\u7528\u6237",visible:1===n,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.addOrUpdateUser,onCancel:function(){e.setState({visible:!1})}},r.a.createElement(Je,{setForm:function(t){return e.formRef=t},roles:c})),r.a.createElement(X.a,{title:"\u4fee\u6539\u7528\u6237",visible:2===n,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.addOrUpdateUser,onCancel:function(){e.formRef.current.resetFields(),e.setState({visible:!1})}},r.a.createElement(Be,{setForm:function(t){return e.formRef=t},roles:c,user:l})))}}]),a}(n.PureComponent),Qe=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,c=new Array(n),l=0;l<n;l++)c[l]=arguments[l];return(e=t.call.apply(t,[this].concat(c))).formRef=r.a.createRef(),e}return Object(i.a)(a,[{key:"componentWillMount",value:function(){this.props.setForm(this.formRef)}},{key:"render",value:function(){return r.a.createElement(f.a,{ref:this.formRef},r.a.createElement(f.a.Item,{label:"\u7528\u6237\u540d\u79f0",name:"roleName",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\u79f0"}]},r.a.createElement(h.a,null)))}}]),a}(n.Component),$e=(a(963),a(447)),Ze=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;Object(o.a)(this,a),(n=t.call(this,e)).getMenus=function(){return n.state.checkedKeys},n.onCheck=function(e){n.setState({checkedKeys:e})};var r=n.props.role.menus;return n.state={checkedKeys:r},n}return Object(i.a)(a,[{key:"componentWillReceiveProps",value:function(e){var t=e.role.menus;this.setState({checkedKeys:t})}},{key:"render",value:function(){var e=this.props.role,t=this.state.checkedKeys;return r.a.createElement("div",null,r.a.createElement(f.a.Item,{label:"\u7528\u6237\u540d\u79f0",name:"roleName",rules:[{required:!0,message:"\u8bf7\u8f93\u5165\u7528\u6237\u540d\u79f0"}]},r.a.createElement(h.a,{placeholder:e.name,disabled:!0})),r.a.createElement($e.a,{checkable:!0,defaultExpandAll:!0,checkedKeys:t,onCheck:this.onCheck,treeData:[{title:"\u5e73\u53f0\u6743\u9650",key:"all",children:[{title:"\u9996\u9875",key:"/home"},{title:"\u5546\u54c1",key:"/products",children:[{title:"\u54c1\u7c7b\u7ba1\u7406",key:"/category"},{title:"\u5546\u54c1\u7ba1\u7406",key:"/product"}]},{title:"\u7528\u6237\u7ba1\u7406",key:"/user"},{title:"\u89d2\u8272\u7ba1\u7406",key:"/role"},{title:"\u56fe\u5f62\u56fe\u8868",key:"/charts",children:[{title:"\u67f1\u5f62\u56fe",key:"/charts/bar"},{title:"\u6298\u7ebf\u56fe",key:"/charts/line"},{title:"\u997c\u56fe",key:"/charts/pie"}]}]}]}))}}]),a}(n.Component),Xe=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(e){var n;return Object(o.a)(this,a),(n=t.call(this,e)).state={roles:[],role:{},visible:0},n.initColumns=function(){n.columns=[{title:"\u89d2\u8272\u540d\u79f0",dataIndex:"name"},{title:"\u521b\u5efa\u65f6\u95f4",dataIndex:"create_time",render:function(e){return ee(e)}},{title:"\u6388\u6743\u65f6\u95f4",dataIndex:"auth_time",render:ee},{title:"\u6388\u6743\u4eba",dataIndex:"auth_name"}]},n.getRoles=Object(b.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w("/manage/role/list");case 2:0===(t=e.sent).status&&(a=t.data,n.setState({roles:a}));case 4:case"end":return e.stop()}}),e)}))),n.AddRole=function(){n.formRef.current.validateFields().then(function(){var e=Object(b.a)(g.a.mark((function e(t){var a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({visible:0}),a=t.roleName,n.formRef.current.resetFields(),e.next=5,K(a);case 5:0===e.sent.status&&(v.b.success("\u521b\u5efa\u89d2\u8272\u6210\u529f"),n.getRoles());case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},n.updateRole=Object(b.a)(g.a.mark((function e(){var t,a;return g.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.setState({visible:0}),t=n.state.role,a=n.auth.current.getMenus(),t.menus=a,t.auth_time=Date.now(),t.auth_name=H.user.username,e.next=8,W(t);case 8:0===e.sent.status&&(t._id===H.user.role_id?(H.user={},Q(),n.props.history.replace("/login"),v.b.success("\u5f53\u524d\u7528\u6237\u89d2\u8272\u6743\u9650\u4fee\u6539\u6210\u529f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55")):(v.b.success("\u8bbe\u7f6e\u89d2\u8272\u6743\u9650\u6210\u529f"),n.setState({roles:Object(Me.a)(n.state.roles)})));case 10:case"end":return e.stop()}}),e)}))),n.handleCancel=function(){n.setState({visible:0})},n.auth=r.a.createRef(),n}return Object(i.a)(a,[{key:"componentWillMount",value:function(){this.initColumns()}},{key:"componentDidMount",value:function(){this.getRoles()}},{key:"render",value:function(){var e=this,t=this.state,a=t.roles,n=t.role,c=t.visible,l=r.a.createElement("span",null,r.a.createElement(d.a,{type:"primary",style:{marginRight:20},onClick:function(){return e.setState({visible:1})}},"\u521b\u5efa\u89d2\u8272"),r.a.createElement(d.a,{type:"primary",disabled:!n._id,onClick:function(){return e.setState({visible:2})}},"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650"));return r.a.createElement(Oe.a,{title:l},r.a.createElement(Ne.a,{bordered:!0,rowKey:"_id",columns:this.columns,dataSource:a,rowSelection:{type:"radio",selectedRowKeys:[n._id],onSelect:function(t){e.setState({role:t})}},pagination:{defaultPageSize:5,showQuickJumper:!0},onRow:function(t){return{onClick:function(a){console.log("Role,Click",t),e.setState({role:t})}}}}),r.a.createElement(X.a,{title:"\u6dfb\u52a0\u89d2\u8272",visible:1===c,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.AddRole,onCancel:this.handleCancel},r.a.createElement(Qe,{setForm:function(t){return e.formRef=t}})),r.a.createElement(X.a,{title:"\u8bbe\u7f6e\u89d2\u8272\u6743\u9650",visible:2===c,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:this.updateRole,onCancel:this.handleCancel},r.a.createElement(Ze,{ref:this.auth,role:n})))}}]),a}(n.Component),Ye=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={sales:[5,20,36,10,10,20],stores:[6,20,40,20,15,30]},e.update=function(){e.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),stores:e.stores.reduce((function(e,t){return e.push(t-1),e}),[])}}))},e.getOption=function(e,t){return{title:{text:"\u9500\u552e\u67f1\u72b6\u56fe"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u6587\u5177","\u852c\u83dc","\u70df","\u9152","\u96f6\u98df","\u5a03\u54c8\u54c8"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"bar",data:e},{name:"\u5e93\u5b58",type:"bar",data:t}]}},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.state,t=e.sales,a=e.stores;return r.a.createElement("div",null,r.a.createElement(Oe.a,null,r.a.createElement(d.a,{type:"primary",onClick:this.update},"\u66f4\u65b0")),r.a.createElement(Oe.a,{title:"\u67f1\u72b6\u56fe"},r.a.createElement(Ie.a,{option:this.getOption(t,a)})))}}]),a}(n.Component),et=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).state={sales:[5,20,36,10,10,20],stores:[6,20,40,20,15,30]},e.update=function(){e.setState((function(e){return{sales:e.sales.map((function(e){return e+1})),stores:e.stores.reduce((function(e,t){return e.push(t-1),e}),[])}}))},e.getOption=function(e,t){return{title:{text:"\u9500\u552e\u67f1\u72b6\u56fe"},tooltip:{},legend:{data:["\u9500\u91cf","\u5e93\u5b58"]},xAxis:{data:["\u6587\u5177","\u852c\u83dc","\u70df","\u9152","\u96f6\u98df","\u5a03\u54c8\u54c8"]},yAxis:{},series:[{name:"\u9500\u91cf",type:"line",data:e},{name:"\u5e93\u5b58",type:"line",data:t}]}},e}return Object(i.a)(a,[{key:"render",value:function(){var e=this.state,t=e.sales,a=e.stores;return r.a.createElement("div",null,r.a.createElement(Oe.a,null,r.a.createElement(d.a,{type:"primary",onClick:this.update},"\u66f4\u65b0")),r.a.createElement(Oe.a,{title:"\u67f1\u72b6\u56fe"},r.a.createElement(Ie.a,{option:this.getOption(t,a)})))}}]),a}(n.Component),tt=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).getOption=function(){return{title:{text:"\u9500\u552e\u997c\u72b6\u56fe",left:"center"},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},legend:{orient:"vertical",left:"left",data:["\u9152","\u70df","\u5a03\u54c8\u54c8","\u6587\u5177","\u852c\u83dc"]},series:[{name:"\u8bbf\u95ee\u6765\u6e90",type:"pie",radius:"80%",center:["50%","60%"],data:[{value:335,name:"\u9152"},{value:310,name:"\u70df"},{value:234,name:"\u5a03\u54c8\u54c8"},{value:135,name:"\u6587\u5177"},{value:1548,name:"\u852c\u83dc"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]}},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Oe.a,null,r.a.createElement(Ie.a,{option:this.getOption()})))}}]),a}(n.Component),at=(a(977),function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){var e;Object(o.a)(this,a);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(e=t.call.apply(t,[this].concat(r))).goHome=function(){e.props.history.replace("/home")},e}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(Ee.a,{className:"not-found"},r.a.createElement(ke.a,{span:12,className:"left"}),r.a.createElement(ke.a,{span:12,className:"right"},r.a.createElement("h1",null,"404"),r.a.createElement("h2",null,"\u62b1\u6b49\uff0c\u4f60\u8bbf\u95ee\u7684\u9875\u9762\u4e0d\u5b58\u5728"),r.a.createElement("div",null,r.a.createElement(d.a,{type:"primary",onClick:this.goHome},"\u56de\u5230\u9996\u9875"))))}}]),a}(n.Component)),nt=Z.a.Footer,rt=Z.a.Sider,ct=Z.a.Content,lt=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){var e=H.user;return e&&e._id?r.a.createElement(Z.a,{style:{minHeight:"100%"}},r.a.createElement(rt,null,r.a.createElement(be,null)),r.a.createElement(Z.a,null,r.a.createElement(de,null,"Header"),r.a.createElement(ct,{style:{margin:20,backgroundColor:"#fff"}},r.a.createElement(p.d,null,r.a.createElement(p.a,{exact:!0,from:"/",to:"/home"}),r.a.createElement(p.b,{path:"/home",component:Re}),r.a.createElement(p.b,{path:"/category",component:Fe}),r.a.createElement(p.b,{path:"/product",component:ze}),r.a.createElement(p.b,{path:"/user",component:Ge}),r.a.createElement(p.b,{path:"/role",component:Xe}),r.a.createElement(p.b,{path:"/charts/bar",component:Ye}),r.a.createElement(p.b,{path:"/charts/line",component:et}),r.a.createElement(p.b,{path:"/charts/pie",component:tt}),r.a.createElement(p.b,{component:at}))),r.a.createElement(nt,{style:{textAlign:"center"}},"\u63a8\u8350\u4f7f\u7528\u8c37\u6b4c\u6d4f\u89c8\u5668\uff0c\u53ef\u4ee5\u83b7\u5f97\u66f4\u4f73\u9875\u9762\u64cd\u4f5c\u4f53\u9a8c"))):r.a.createElement(p.a,{to:"/login"})}}]),a}(n.Component),ot=function(e){Object(u.a)(a,e);var t=Object(s.a)(a);function a(){return Object(o.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(m.a,null,r.a.createElement(p.d,null,r.a.createElement(p.b,{path:"/login",component:$}),r.a.createElement(p.b,{path:"/",component:lt})))}}]),a}(n.Component),it=(a(978),G());H.user=it,l.a.render(r.a.createElement(ot,null),document.getElementById("root"))}},[[449,1,2]]]);
//# sourceMappingURL=main.9ecc1bb1.chunk.js.map